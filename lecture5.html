<!DOCTYPE html>
<html lang="en"><head>
<script src="lecture5_files/libs/clipboard/clipboard.min.js"></script>
<script src="lecture5_files/libs/quarto-html/tabby.min.js"></script>
<script src="lecture5_files/libs/quarto-html/popper.min.js"></script>
<script src="lecture5_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lecture5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lecture5_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet">
<link href="lecture5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.501">

  <meta name="author" content="Matthias Mittner">
  <title>Multi-level linear regression, factor analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lecture5_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lecture5_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="lecture5_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="style.css">
  <link href="lecture5_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lecture5_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lecture5_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lecture5_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="lecture5_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="lecture5_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <script src="lecture5_files/libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="lecture5_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Multi-level linear regression, factor analysis</h1>
  <p class="subtitle">PSY-8003: Multivariate kvantitative forskningsmetoder</p>
  <p class="author">Matthias Mittner</p>
  <p class="institute">Institute for Psychology</p>
  <p class="date">v2022</p>
</section>

<section class="slide level1">

<div class="cell">

</div>
</section>
<section id="outline" class="slide level1">
<h1>Outline</h1>
<div class="columns">
<div class="column" style="width:55%;">
<ul>
<li>Exploratory factor analysis</li>
<li>What Are factors?</li>
<li>Representing factors
<ul>
<li>Graphs and Equations</li>
</ul></li>
<li>Extracting factors
<ul>
<li>Methods and Criteria</li>
</ul></li>
<li>Interpreting factor structures
<ul>
<li>Factor Rotation</li>
</ul></li>
<li>Factor scores/Composite scores
<ul>
<li>Cronbach’s alpha</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_rbook_figure13.02.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-is-factor-analysis" class="slide level1">
<h1>What is factor analysis?</h1>
<div class="columns">
<div class="column" style="width:45%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/Research_areas_in_psychology_Art_1.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<p>In psychology…</p>
<ul>
<li>we study complex and abstract concepts</li>
<li>with somewhat fuzzy definitions</li>
<li>that cannot be measured directly</li>
</ul>
<p>Examples:</p>
<ul>
<li>“burnout”, “intelligence”, “love”, …</li>
<li>“depression”, “extraversion”, “expertise”, …</li>
</ul>
</div>
</div>
<h2 id="section"></h2>
<p>Solution: measure many related variables and <em>infer</em> (latent) concept…</p>
</section>
<section id="what-is-factor-analysis-1" class="slide level1">
<h1>What is factor analysis?</h1>

<img data-src="pics/fa_illustr.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="goals">Goals</h2>
<ul>
<li>data/variable-reduction</li>
<li>determine “dimensionality” of a dataset</li>
<li>uncover latent factors underlying a set of variables</li>
</ul>
</section>
<section id="example-factor-structure-of-cognitive-abilities" class="slide level1">
<h1>Example: Factor structure of cognitive abilities</h1>
<p>Spearman’s <span class="math inline">\(g\)</span>-factor</p>

<img data-src="pics/fa_spearman_gmatrix.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>historical data from Spearman (1904): six measures of school performance, all highly (positively) correlated</li>
<li>students that were good in one field where usually also good in others</li>
<li>“positive manifold phenomenon”: consistent finding of universally positive correlation matrices of mental test results</li>
</ul>
</section>
<section id="example-factor-structure-of-cognitive-abilities-1" class="slide level1">
<h1>Example: Factor structure of cognitive abilities</h1>
<h2 id="section-1"></h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="pics/spearman.png" style="width:40.0%"> <img data-src="pics/400px-SpearmanFactors.svg.png" style="width:49.0%"></p>
</div><div class="column" style="width:69%;">
<ul>
<li>Charles Spearman (1863-1945)</li>
<li>two-factor theory or intelligence</li>
<li>a general (<span class="math inline">\(g\)</span>)-factor and several “specific” factors</li>
</ul>
</div>
</div>
<h2 id="section-2"></h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="pics/Raymond_Cattell.jpg" style="width:30.0%"> <img data-src="pics/fluid_cristallized.jpg" style="width:65.0%"></p>
</div><div class="column" style="width:69%;">
<ul>
<li>Raymond Cattell (1905-1998)</li>
<li><span class="math inline">\(g\)</span>-factor divided into fluid (<span class="math inline">\(G_f\)</span>) and cristallized (<span class="math inline">\(G_c\)</span>) intelligence</li>
<li>especially: lifespan-development</li>
</ul>
</div>
</div>
<h2 id="section-3"></h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="pics/carroll.png" style="width:35.0%"> <img data-src="pics/threestratumtheory.jpg" style="width:60.0%"></p>
</div><div class="column" style="width:69%;">
<ul>
<li>John B. Carroll (1916–2003)</li>
<li>three-stratum theory of intelligence: 3 “layers” from general <span class="math inline">\(g\)</span> to specific</li>
</ul>
</div>
</div>
<h2 id="section-4"></h2>
<p>All these theories use Factor-analysis as their main tool!</p>
</section>
<section id="refined-theories" class="slide level1">
<h1>Refined theories</h1>

<img data-src="pics/Carroll_three_stratum_model_of_human_Intelligence.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>three-stratum theory (Caroll, 1993)</li>
<li><span class="math inline">\(g\)</span> factor on most general level</li>
<li>“broad” abilities: fluid intelligence (Gf), crystallized intelligence (Gc), general memory and learning (Gy), broad visual perception (Gv), broad auditory perception (Gu), broad retrieval ability (Gr), broad cognitive speediness (Gs), and processing speed (Gt)</li>
</ul>
</section>
<section id="factor-analysis-goals" class="slide level1">
<h1>Factor analysis goals</h1>

<img data-src="pics/Carroll_three_stratum_model_of_human_Intelligence.png" style="width:30.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="determine-dimensionality-of-a-dataset">Determine “dimensionality” of a dataset</h2>
<ul>
<li>is there a single <span class="math inline">\(g\)</span> or are there multiple underlying factors?</li>
</ul>
<h2 id="reduce-dimensionality">Reduce dimensionality</h2>
<ul>
<li>three-stratum theory based on 460 studies including hundreds of cognitive tests</li>
</ul>
<h2 id="discover-underlying-factors">Discover underlying factors</h2>
<ul>
<li>determine and extract fluid intelligence, crystallized intelligence etc</li>
<li>do these factors make a difference in practice?
<ul>
<li>different life-trajectories?</li>
<li>different neural correlates?</li>
<li>different correlations to success in life?</li>
<li>…</li>
</ul></li>
</ul>
</section>
<section id="example-2-personality-psychology" class="slide level1">
<h1>Example 2: Personality psychology</h1>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/big-five-personality-traits-infographic.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:49%;">
<ul>
<li>hundreds of verbal descriptions of personality (adjectives) were scored and factor-analysed</li>
<li>good evidence for five main factors</li>
<li>“Big-Five” (NEO-FFI)</li>
<li>related to health, education, career-choice etc</li>
</ul>
</div>
</div>
</section>
<section id="exploratory-efa-vs.-confirmatory-cfa-factor-analysis" class="slide level1">
<h1>Exploratory (EFA) vs.&nbsp;confirmatory (CFA) factor analysis</h1>

<img data-src="pics/exploratory_confirmatory.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="efa">EFA</h2>
<ul>
<li>data-driven</li>
<li>determine factors that are “in the data”</li>
<li>minimal guidance through theory</li>
</ul>
<h2 id="cfa">CFA</h2>
<ul>
<li>theory-driven</li>
<li>is a specified “factor model” represented in the data?</li>
<li>special case of structural-equation modeling (SEM)</li>
</ul>
</section>
<section id="example" class="slide level1 smaller">
<h1>Example</h1>
<p>Questionnaire on environmental norms</p>

<img data-src="pics/ecofriend.png" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>1 = totally disagree to 5 = totally agree</li>
</ul>
<h3 id="items-in-the-questionnaire">Items in the questionnaire</h3>
<ul>
<li><code>Var1</code>: Most of my friends think I should use environmentally friendly products</li>
<li><code>Var2</code>: Most of my neighbours think I should use environmentally friendly products</li>
<li><code>Var3</code>: Most of my colleagues think I should use environmentally friendly products</li>
<li><code>Var4</code>: I feel a moral obligation to buy environmentally friendly products</li>
<li><code>Var5</code>: I feel a moral obligation to recycle household waste</li>
<li><code>Var6</code>: I feel a moral obligation to buy products made with recycled ingredients</li>
</ul>
</section>
<section id="questionnaire-on-environmental-norms" class="slide level1">
<h1>Questionnaire on environmental norms</h1>

<img data-src="pics/fa_excelvar.png" style="width:60.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>1 = totally disagree to 5 = totally agree</li>
<li>masurements from every participant</li>
<li>do some items belong together?</li>
</ul>
</section>
<section id="from-data-to-correlation-matrix" class="slide level1">
<h1>From data to correlation matrix</h1>

<img data-src="pics/fa_rbook_figure13.01_tweak.png" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>calculate all pairwise correlations</li>
<li>lower-diagonal matrix (upper half is symmetric, <span class="math inline">\(r(A,B)=r(B,A)\)</span>)</li>
<li>diagonal is <span class="math inline">\(r(A,A)=1\)</span></li>
<li>can we detect pattern in this correlation matrix?</li>
</ul>
</section>
<section id="factors-to-explain-correlation-patterns" class="slide level1">
<h1>Factors to explain correlation patterns</h1>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_twofac.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:59%;">
<ul>
<li><p>variables 1-3 are highly correlated</p></li>
<li><p>variables 4-6 are highly correlated</p></li>
<li><p>correlations between the two are low</p></li>
<li><p>use two factors to explain this</p></li>
<li><p>Factor 1 <span class="math inline">\(\approx\)</span> Social Norms (friends, neighbours, colleagues)</p></li>
<li><p>Factor 2 <span class="math inline">\(\approx\)</span> Personal Norms (“I feel a moral obligation”)</p></li>
</ul>
</div>
</div>
<h2 id="section-5"></h2>
<ul>
<li>these “factors” are based on inspection of the correlation matrix and item formulation!</li>
</ul>
</section>
<section id="factors-from-exploratory-factor-analysis-efa" class="slide level1">
<h1>Factors from Exploratory Factor Analysis (EFA)</h1>

<img data-src="pics/fa_rbook_figure13.02.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="section-6"></h2>
<ul>
<li>in EFA, all items are (possibly) connected to all factors <em>a priori</em></li>
<li>EFA “figures out” an internal structure</li>
<li>we don’t give any theoretical guidance</li>
</ul>
</section>
<section id="fa-as-regression" class="slide level1">
<h1>FA as “regression”</h1>

<img data-src="pics/fa_rbook_figure13.02.png" style="width:30.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li><code>Var1</code> <span class="math inline">\(=\beta_{1,1}\times\text{Social Norms} + \beta_{2,1}\times\text{Personal Norms} + \epsilon\)</span></li>
<li><code>Var2</code> <span class="math inline">\(=\beta_{1,2}\times\text{Social Norms} + \beta_{2,2}\times\text{Personal Norms} + \epsilon\)</span></li>
<li><code>Var3</code> <span class="math inline">\(=\beta_{1,3}\times\text{Social Norms} + \beta_{2,3}\times\text{Personal Norms} + \epsilon\)</span></li>
<li><code>Var4</code> <span class="math inline">\(=\beta_{1,4}\times\text{Social Norms} + \beta_{2,4}\times\text{Personal Norms} + \epsilon\)</span></li>
<li><code>Var5</code> <span class="math inline">\(=\beta_{1,5}\times\text{Social Norms} + \beta_{2,5}\times\text{Personal Norms} + \epsilon\)</span></li>
<li><code>Var6</code> <span class="math inline">\(=\beta_{1,6}\times\text{Social Norms} + \beta_{2,6}\times\text{Personal Norms} + \epsilon\)</span></li>
</ul>
<p>(Intercept was dropped, assuming that variables are standardized)</p>
<h2 id="little-problem">Little problem:</h2>
<p>We do not know the value of the factors “Social Norms” and “Personal Norms” …</p>
</section>
<section id="fa-as-regression-1" class="slide level1">
<h1>FA as “regression”</h1>
<p><span class="math display">\[
Y_{ji}=\beta_{1j} X_{1i} + \beta_{2j} X_{2i} + \epsilon_{ji}
\]</span></p>
<h2 id="section-7"></h2>
<ul>
<li>item <span class="math inline">\(j\)</span> and person <span class="math inline">\(i\)</span></li>
<li>for each variable <span class="math inline">\(j\)</span> (<code>Var1</code>, <code>Var2</code>, …):
<ul>
<li>the regression coefficients <span class="math inline">\(\beta_{1j}\)</span> and <span class="math inline">\(\beta_{2j}\)</span> are called <span style="color: red;">factor loadings</span></li>
<li>the error term <span class="math inline">\(\epsilon_{ji}\)</span> is called <span style="color: red;">uniqueness</span></li>
<li>the <span class="math inline">\(R^2\)</span> for each of the models is called <span style="color: red;">communality</span></li>
</ul></li>
<li>since the factor-scores are unknown <em>a priori</em>, other criteria must be added to make solution <em>identifiable</em> (possible to estimate)</li>
</ul>
</section>
<section id="partitioning-the-variance-in-factor-analysis" class="slide level1">
<h1>Partitioning the variance in factor analysis</h1>

<img data-src="pics/fa_communalities.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>FA decomposes variance in each item into
<ul>
<li>“common” variance (shared with other items): <span style="color: red;">communality</span></li>
<li>“unique” variance for each variable: <span style="color: red;">uniqueness</span></li>
</ul></li>
<li>the unique variance can be further divided into “specific” and “error” variances
<ul>
<li>specific variance: e.g., biased wording affecting a specific item</li>
<li>error variance: e.g., mood influences responding to a specific item</li>
</ul></li>
</ul>
</section>
<section id="partitioning-the-variance-in-factor-analysis-1" class="slide level1">
<h1>Partitioning the variance in factor analysis</h1>

<img data-src="pics/fa_saq_decomp.png" style="width:60.0%" class="r-stretch quarto-figure-center"><p class="caption"></p></section>
<section id="communalities-h2" class="slide level1">
<h1>Communalities <span class="math inline">\(h^2\)</span></h1>

<img data-src="pics/fa_communalities.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>Definition: Percentage of variance in a variable explained by factors</li>
<li>Intuition: how much does a variable have in common with the factors?</li>
<li>Items with low <span class="math inline">\(h^2\)</span> fall “outside” the factor solution</li>
<li>Rule of thumb:
<ul>
<li><span class="math inline">\(&lt;.1\)</span> is extremly low, <span class="math inline">\(&lt;.2\)</span> is very low, <span class="math inline">\(&lt;.4\)</span> is low, <span class="math inline">\(&lt;.5\)</span> is somewhat low</li>
<li>compare relative to other item’s <span class="math inline">\(h^2\)</span></li>
</ul></li>
</ul>
</section>
<section id="fa-process" class="slide level1">
<h1>FA process</h1>

<img data-src="pics/fa_fields_process.png" class="r-stretch quarto-figure-center"><p class="caption"></p><p>(Fields, 2017)</p>
</section>
<section id="fa-process-1" class="slide level1">
<h1>FA process</h1>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_rbook_figure13.03.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:59%;">
<ul>
<li>in practice, EFA process is often circular and iterative</li>
<li>based on results from preliminary EFA, different choices can be made
<ul>
<li>dropping items that have high uniqueness/low communality (“orphans”)</li>
<li>choosing different methods (number of factors, rotation etc)</li>
</ul></li>
<li>goal: get a good fitting model that explains the data well</li>
</ul>
</div>
</div>
<p>(Mehmetoglu &amp; Mittner, 2021)</p>
</section>
<section id="factor-analysis-requirements" class="slide level1">
<h1>Factor analysis requirements</h1>

<img data-src="pics/fa_fields_process_initial.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="can-and-should-i-run-a-factor-analysis-on-my-dataset">Can and should I run a factor analysis on my dataset?</h2>
<ul>
<li>Factorability</li>
<li>adequate sample size</li>
<li>linearity</li>
<li>metric (continuous variables)</li>
</ul>
</section>
<section id="factorability" class="slide level1">
<h1>Factorability</h1>
<p>Is the dataset useful for FA?</p>

<img data-src="pics/Correlation-matrix-based-hierarchical-clustering-of-activities-of-mice-recorded-on.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="section-8"></h2>
<ul>
<li>are there high correlations between the different variables?</li>
<li>can we identify “groups” of correlated variables (clusters)?</li>
<li>formal procedure: Kaiser-Meyer-Olkin (KMO) Test</li>
</ul>
</section>
<section id="factorability-1" class="slide level1">
<h1>Factorability</h1>
<p>Kaiser-Meyer-Olkin (KMO) Test</p>
<div class="columns">
<div class="column" style="width:40%;">
<p><span class="math display">\[
\text{KMO} = \frac{\displaystyle \underset{j\neq k}{\sum} r_{jk}^2}{\displaystyle \underset{j\neq k}{\sum} r_{jk}^2+\underset{j\neq k}{\sum} p_{jk}^2}
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_kmo.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:59%;">
<ul>
<li>measure of how suited your data is for Factor Analysis</li>
<li>KMO has values between 0 and 1</li>
<li>rule of thumb:
<ul>
<li>KMO values between 0.8 and 1: sampling is adequate</li>
<li>KMO values &lt;0.6 (sometimes 0.5): sampling is not adequate</li>
<li>KMO Values close to zero: there are large partial correlations compared to the sum of correlations</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="sample-size" class="slide level1 smaller">
<h1>Sample size</h1>
<p>What is an adequate sample size?</p>
<ul>
<li>Formal Power-analysis difficult/impossible (what is the hypothesis test?)</li>
<li>But: relatively large sample necessary for reproducibility of factor structure</li>
<li>higher communalities <span class="math inline">\(\rightarrow\)</span> smaller sample required</li>
<li>more items per factor <span class="math inline">\(\rightarrow\)</span> smaller sample required</li>
<li>more factors <span class="math inline">\(\rightarrow\)</span> larger sample required</li>
<li>many rules of thumb out there, e.g.:
<ul>
<li>100 subjects=sufficient if clear structure; more is better (Kline, 1994)</li>
<li>100 subjects=poor; 300 =good; 1000+ = excellent (Comrey &amp; Lee, 1992)</li>
<li>300 subjects, though fewer works if correlations are high among variables (Tabachnik &amp; Fidell, 2001)</li>
</ul></li>
</ul>
</section>
<section id="determining-the-number-of-factors" class="slide level1">
<h1>Determining the number of factors</h1>

<img data-src="pics/fa_rbook_figure13.03.png" style="width:30.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="many-rules-for-determining-number-of-factors">Many “rules” for determining number of factors</h2>
<ul>
<li>Kaiser’s criterion (Eigenvalue rule)</li>
<li>Scree-plot</li>
<li>Parallel Analysis</li>
<li>Theoretical reasoning</li>
</ul>
</section>
<section id="eigenvalues-and-eigenvectors" class="slide level1">
<h1>Eigenvalues and Eigenvectors</h1>

<img data-src="pics/eigenvalue.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>each factor is associated with an <em>Eigenvalue</em> and an <em>Eigenvector</em></li>
<li>the eigenvalue reflects the amount of variance explained</li>
<li>Eigenvalues always decrease with factor number (first factor explains most)</li>
<li>Eigenvalue on “item” scale:
<ul>
<li>20 items: an eigenvalue of 10 means that the factor contains as much information as 10 items</li>
</ul></li>
</ul>
</section>
<section id="eigenvalue-rule" class="slide level1">
<h1>Eigenvalue rule</h1>

<img data-src="pics/fa_rbook_figure13.04.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>select factors with eigenvalue &gt; 1 (explains at least as much as one item)</li>
<li>or: select factors with eigenvalue &gt; average communality</li>
</ul>
</section>
<section id="scree-plot" class="slide level1">
<h1>Scree plot</h1>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/Yamnuska_bottom_cliff.jpg" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:59%;">
<ul>
<li>Scree: “an accumulation of loose stones or rocky debris lying on a slope or at the base of a hill or cliff”</li>
<li>Scree-plot: Eigenvalue vs.&nbsp;component number</li>
<li>we want the big cliff, not the scree at the bottom</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/scree-plot-example.jpg" style="width:60.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scree-plot-1" class="slide level1">
<h1>Scree plot</h1>
<p>combined with Kaiser’s criterion</p>

<img data-src="pics/fa_stata_scree_bfi.png" style="width:50.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>Kaiser’s criterion: retain 4 factors (or 5 if &gt;average)</li>
<li>Scree-criterion: retain 5 factors</li>
<li>theory: 5 factors (NEO-FFI, five-factor inventory)</li>
<li>FA on measures from the NEO-FFI on a sample of N=2436 participants</li>
</ul>
</section>
<section id="parallel-analysis" class="slide level1">
<h1>Parallel analysis</h1>

<img data-src="pics/fa_fapara_bfi.png" style="width:40.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>simulation-based</li>
<li>generate <span class="math inline">\(N\)</span> random datasets with the same number of subjects and variables</li>
<li>run FA and calculate eigenvalues</li>
<li>compare real Eigenvalues to the random ones</li>
<li>interesting method but sometimes too lenient</li>
</ul>
</section>
<section id="factor-extraction-methods" class="slide level1">
<h1>Factor extraction methods</h1>

<img data-src="pics/fa_rbook_figure13.03.png" style="width:20.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>how to extract the factors from the correlation matrix?</li>
<li>Most common methods:
<ul>
<li>principal component analysis (PCA)</li>
<li>principal factor analysis (PF)</li>
<li>iterated PF (IPF)</li>
<li>maximum-likelihood factor analysis (ML)</li>
</ul></li>
<li>PCA and PF/IPF/ML are distinct
<ul>
<li>PCA uses raw correlation matrix</li>
<li>other methods use a communality estimate in the diagonal</li>
</ul></li>
</ul>
</section>
<section id="factor-extraction-methods-1" class="slide level1">
<h1>Factor extraction methods</h1>
<p><img data-src="pics/fa_rbook_figure13.01_tweak.png" style="width:48.0%"><img data-src="pics/fa_rbook_figure13.01.png" style="width:48.0%"></p>
<ul>
<li>PCA: raw correlation matrix (<code>1</code> in diagonal)
<ul>
<li>analyses “variance rather than covariance”</li>
</ul></li>
<li>PFA: replace <code>1</code> in diagonal with squared multiple correlations (SMC)
<ul>
<li>serves as initial estimate of communality</li>
<li>assumption: some of the variance in the variables is caused by other sources</li>
<li>analyses “covariance rather than variance”</li>
</ul></li>
<li>IPF: repeat PFA but replace initial estimate of <span class="math inline">\(h^2\)</span></li>
</ul>
</section>
<section id="pfa-factor-extraction" class="slide level1">
<h1>PFA factor extraction</h1>

<img data-src="pics/fa_rbook_figure13.01.png" style="width:58.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><h2 id="section-9"></h2>
<ol start="0" type="1">
<li><p>Estimate communalities and replace in diagonal</p></li>
<li><p>Calculate eigenvector/eigenvalue</p></li>
<li><p>Subtract from correlation matrix: residual matrix</p></li>
<li><p>repeat 1. and 2. as often as needed</p></li>
</ol>
<ul>
<li>the Eigenvectors (<em>loadings</em>) and Eigenvalues (<em>explained variance</em>) are the main result of the FA process</li>
</ul>
</section>
<section id="pfa-factor-extraction-1" class="slide level1">
<h1>PFA factor extraction</h1>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_ipf.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:49%;">
<ul>
<li>check “proportion explained” and “cumulative proportion explained”</li>
<li>choose number of factors!</li>
<li>loadings <span class="math inline">\(l_i=w_i\times\sqrt{e_i}\)</span> (eigenvector times square root of eigenvalue)</li>
<li>communality <span class="math inline">\(h^2_i=\sum{l_i^2}\)</span></li>
<li>uniqueness <span class="math inline">\(1-h^2\)</span></li>
</ul>
</div>
</div>
</section>
<section id="the-hunt-for-simple-structure" class="slide level1">
<h1>The hunt for “simple structure”</h1>
<div class="columns">
<div class="column" style="width:25%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_rbook_figure13.03.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_factorpf_loadings.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We really want:</p>
<ul>
<li>each variable should “load” highly on exactly one factor</li>
<li>this is called “simple structure”</li>
<li>makes interpretation of factors much easier</li>
</ul>
</section>
<section id="rotation-of-factors" class="slide level1">
<h1>Rotation of factors</h1>

<img data-src="pics/fa_rbook_figure13.05.png" style="width:60.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>redistributing the amount of variance explained by each factor</li>
<li>does not change total variance explained (communality)</li>
<li>mathematical fit is identical</li>
</ul>
</section>
<section id="neo-ffi-big-five" class="slide level1">
<h1>NEO-FFI (Big-Five)</h1>
<p>unrotated vs.&nbsp;rotated solution…</p>
<div class="columns">
<div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_unrotated_bfi.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_rotated_bfi.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="rotation-of-factors-1" class="slide level1">
<h1>Rotation of factors</h1>
<p>Orthogonal vs.&nbsp;oblique rotation</p>
<div class="columns">
<div class="column" style="width:49%;">
<p>Orthogonal &gt; <img data-src="pics/fa_rbook_figure13.05.png" style="width:88.0%"></p>
<ul>
<li>factors are uncorrelated</li>
<li>“varimax” (maximize explained variance)</li>
</ul>
</div><div class="column" style="width:49%;">
<p>Oblique</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_rbook_figure13.06.png" style="width:79.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
<ul>
<li>correlation of factors allowed</li>
<li>“promax(<span class="math inline">\(\kappa\)</span>)” method</li>
</ul>
</div>
</div>
</section>
<section id="rotation-of-factors-2" class="slide level1">
<h1>Rotation of factors</h1>
<p>Orthogonal vs.&nbsp;oblique rotation</p>

<img data-src="pics/fa_rbook_figure13.07.png" style="width:59.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>Orthogonal rotation
<ul>
<li>uncorrelated components</li>
<li>interpret rotated component loadings</li>
<li>sum of rotated eigenvalues = sum of unrotated EVs</li>
</ul></li>
<li>Oblique rotation
<ul>
<li>correlated factors (makes sense intuitively)</li>
<li>interpret pattern matrix &amp; component correlation matrix</li>
<li>sum of rotated eigenvalues &gt; sum of unrotated eigenvalues</li>
</ul></li>
</ul>
</section>
<section id="big-five-rotated-solution" class="slide level1">
<h1>Big-Five rotated solution</h1>
<p>Factor correlation matrix</p>
<div class="columns">
<div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_rotated_bfi.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_stata_rotated_bfi_facorr.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
<ul>
<li>interpret both
<ul>
<li>rotated factor-loadings<br>
</li>
<li>factor-correlation matrix</li>
</ul></li>
<li>if factors are uncorrelation, matrix should contain low off-diagonal values</li>
</ul>
</div>
</div>
</section>
<section id="interpreting-factor-loadings" class="slide level1">
<h1>Interpreting factor loadings</h1>

<img data-src="pics/fa_stata_unorated_loading.png" style="width:40.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><p><strong>Example:</strong></p>
<ul>
<li>loading of <code>Var6</code> on factor 1 is <span class="math inline">\(-0.17\)</span>
<ul>
<li><span class="math inline">\((-0.17)^2=0.03\)</span> means that factor 1 explains 3% of the variance in <code>Var6</code></li>
</ul></li>
<li>loading of <code>Var6</code> on factor 2 is <span class="math inline">\(0.88\)</span>
<ul>
<li><span class="math inline">\((0.88)^2=0.77\)</span> means that factor 2 explains 77% of the variance in <code>Var6</code></li>
</ul></li>
<li>together, the factors explain <span class="math inline">\(3\% + 77\%=80\%\)</span> of the variance (<span class="math inline">\(=h^2\)</span>)</li>
<li>uniqueness = <span class="math inline">\(1-h^2=20\%\)</span> for <code>Var6</code></li>
</ul>
</section>
<section id="interpreting-factor-loadings-1" class="slide level1">
<h1>Interpreting factor loadings</h1>

<img data-src="pics/fa_rbook_figure13.07.png" style="width:49.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>orthogonal rotation:
<ul>
<li>factor loading corresponds directly to the standardized coefficient in a bivariate regression</li>
<li>interpretation: “for every unit increase in factor 1, <code>Var6</code> will change by 0.88 units”</li>
</ul></li>
<li>oblique rotation:
<ul>
<li>factor loading corresponds to the partial standardized coefficient in multiple regression</li>
<li>interpretation: “for every unit increase in factor 1, <code>Var6</code> will change by 0.88 units controlled for factor 2”</li>
</ul></li>
</ul>
</section>
<section id="factor-plot" class="slide level1">
<h1>Factor plot</h1>

<img data-src="pics/fa_fields_factorplot.png" class="r-stretch quarto-figure-center"><p class="caption"></p></section>
<section id="labelingrefining-factors" class="slide level1">
<h1>Labeling/refining factors</h1>

<img data-src="pics/fa_rbook_figure13.03.png" style="width:25.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><p>Examine factor pattern matrix (loadings):</p>
<ul>
<li>what have items loading high on a factor in common?</li>
<li>negative loadings <span class="math inline">\(\rightarrow\)</span> flip sign?</li>
<li>loadings <span class="math inline">\(&lt;.4\)</span> can typically be disregarded</li>
<li>variables loading weakly on all factors can be removed (removal one-by-one with re-estimation of FA)</li>
<li>variables loading on multiple variables: exclude (?)</li>
<li>find labels for the factors based on items loading highly on it</li>
</ul>
</section>
<section id="calculating-factor-scores" class="slide level1">
<h1>Calculating factor scores</h1>
<p>a.k.a. Composite scores</p>

<img data-src="pics/fa_excel_fascore.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>often, factor-scores should be used in additional analyses/studies, e.g.
<ul>
<li>which brain regions correlate with the <span class="math inline">\(g\)</span>-factor?</li>
<li>are people scoring high on Neuroticism more prone to mental illness?</li>
<li>…</li>
</ul></li>
<li>calculate factor-scores
<ul>
<li>using <em>regression method</em> (aka <em>estimated</em> factor scores)</li>
<li>using <em>sum-scores</em> (aka <em>generated</em> factor scores)</li>
</ul></li>
</ul>
</section>
<section id="calculating-factor-scores-1" class="slide level1">
<h1>Calculating factor scores</h1>
<p>Regression method</p>

<img data-src="pics/fa_rbook_figure13.08.png" style="width:85.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>weighted sum using score on each item multiplied with loading</li>
<li>equivalent to prediction method in linear regression</li>
</ul>
</section>
<section id="calculating-factor-scores-2" class="slide level1">
<h1>Calculating factor scores</h1>
<p>Sum-score method</p>

<img data-src="pics/fa_excel_facscore_sum.png" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>in case of well-polarized loadings (“simple structure”)</li>
<li>sum/mean of items “belonging” to each factor</li>
</ul>
</section>
<section id="reliability-and-validity-of-the-factor-scores" class="slide level1">
<h1>Reliability and Validity of the factor scores</h1>

<img data-src="pics/reliability_validity.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>measurement should be <em>reliable</em>
<ul>
<li>consistently provide similar estimates for similar situations</li>
</ul></li>
<li>measurement should be <em>valid</em>
<ul>
<li>it should measure what we want it to measure</li>
</ul></li>
</ul>
</section>
<section id="assessing-reliability" class="slide level1 smaller">
<h1>Assessing reliability</h1>
<p>Construct reliability</p>

<img data-src="pics/types_reliability_hl.png" style="width:45.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>reliability=“the LV consistently gives the same measurement”</li>
<li>for SEM evaluation: internal consistency
<ul>
<li>to what degree do the different items measure the same underlying construct?</li>
<li>related but not identical to unidimensionality</li>
</ul></li>
<li>other forms of reliability (ideally conducted during scale development):
<ul>
<li>split-half reliability</li>
<li>test-retest reliability</li>
<li>inter-rater reliability</li>
</ul></li>
</ul>
</section>
<section id="reliability-of-factor-score" class="slide level1">
<h1>Reliability of factor score</h1>
<p>Sum-score method</p>
<p>Cronbach’s <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\alpha=\left(\frac{K}{K-1}\right)\left(\frac{S_{T}^{2}-\sum_{i=1}^{K}S_{i}^{2}}{S_{T}^{2}}\right)
\]</span></p>
<p>where <span class="math inline">\(K\)</span> is the number of variables, <span class="math inline">\(S_{i}^{2}\)</span> is the variance of each variable and <span class="math inline">\(S_{T}^{2}\)</span> is the variance of the summated score.</p>
<ul>
<li><p>measure of reliability (internal consistency)</p></li>
<li><p>between 0 and 1 (larger is better)</p></li>
<li><p>Kline (1999): Reliable if &gt; .7</p></li>
<li><p>depends on the number of items, more questions = bigger <span class="math inline">\(\alpha\)</span></p></li>
<li><p>remember to reverse score reverse phrased items:</p>
<ul>
<li>If not, <span class="math inline">\(\alpha\)</span> is reduced and can even be negative</li>
</ul></li>
</ul>
</section>
<section id="reliability-of-factor-score-1" class="slide level1">
<h1>Reliability of factor score</h1>
<p>Construct reliability</p>
<p>Dillon-Goldstein’s <span class="math inline">\(\rho\)</span> (DG rho)</p>
<p><span class="math display">\[
\rho_{C} = \frac{ \left( \sum_{i=1}^k \lambda_i \right)^2 }{ \left( \sum_{i=1}^k \lambda_i \right)^2 + \sum_{i=1}^k \sigma^{2}_{e_i} }
\]</span></p>
<ul>
<li>uses factor-loadings from measurement model</li>
<li>does not assume <span class="math inline">\(\tau\)</span>-equivalence</li>
<li>should be preferred over <span class="math inline">\(\alpha\)</span> (but Cronbach’s <span class="math inline">\(\alpha\)</span> widely used)</li>
<li>Kline (1999): adequate reliability if <span class="math inline">\(\rho &gt; .7\)</span> but <span class="math inline">\(\rho&lt;.93\)</span> (caution!)</li>
</ul>
</section>
<section id="construct-validity-lvs" class="slide level1">
<h1>Construct validity LVs</h1>

<img data-src="pics/internal-vs-external-validity-thumbanil-1.jpg" style="width:40.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>validity=“the LV measures what we think it measures”</li>
<li><strong>External validity</strong>: does it generalize to other situations/the real world?
<ul>
<li>difficult to test in practice</li>
</ul></li>
<li><strong>Internal validity</strong>: does it make sense within the study?
<ul>
<li>easy to quantify</li>
<li><em>Convergent validity</em>: similar things correlate highly with the measure</li>
<li><em>Divergent validity</em>: dissimilar things do not correlate with the measure</li>
</ul></li>
</ul>
</section>
<section id="assessing-convergent-validity" class="slide level1">
<h1>Assessing convergent validity</h1>

<img data-src="pics/mehmet_sem_convergentval.png" style="width:30.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>based on inter-item correlations (should be high!)</li>
</ul>
<h2 id="criteria-for-convergent-validity">Criteria for convergent validity</h2>
<ol type="1">
<li>factor loadings <span class="math inline">\(\lambda\)</span>
<ul>
<li>reflects correlation bw item and factor</li>
<li><span class="math inline">\(\lambda^2\)</span> = amount of item variance explained by factor</li>
<li>rule of thumb: <span class="math inline">\(\lambda^2&gt;0.5 \rightarrow\lambda &gt; 0.7\)</span></li>
</ul></li>
<li>average variance extracted (AVE) = communality
<ul>
<li>average of squared factor loadings</li>
<li>AVE &gt; 0.5</li>
</ul></li>
</ol>
</section>
<section id="example-assessing-convergent-validity" class="slide level1">
<h1>Example: Assessing convergent validity</h1>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/stata_plssem_loadings_2.png" style="width:40.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/stata_plssem_ave.png" data-with="50%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</section>
<section id="assessing-discriminant-validity" class="slide level1">
<h1>Assessing discriminant validity</h1>

<img data-src="pics/mehmet_sem_discval.png" style="width:60.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>based on inter-construct correlations (should be low!)</li>
</ul>
<h2 id="criteria-for-discriminant-validity">Criteria for discriminant validity</h2>
<ul>
<li>communality (AVE) of the constructs &gt; squared inter-construct correlations
<ul>
<li>Fornell-Larcker criterion</li>
</ul></li>
</ul>
</section>
<section id="example-assessing-convergent-validity-1" class="slide level1">
<h1>Example: Assessing convergent validity</h1>

<img data-src="pics/stata_plssem_ave_2.png" data-with="50%" class="r-stretch quarto-figure-center"><p class="caption"></p></section>
<section id="content-validity" class="slide level1">
<h1>Content validity</h1>
<div class="columns">
<div class="column" style="width:49%;">
<div class="cell">
<div class="cell-output-display">
<div id="cell-handler-fake-div-1">
<p>
<svg width="278" height="116" viewbox="0.00 0.00 278.38 116.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style=" display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-112 274.38,-112 274.38,4 -4,4"></polygon> <!-- multiplication --> <g id="node1" class="node">
<title>
multiplication
</title>
<polygon fill="none" stroke="black" points="94.32,-108 0.23,-108 0.23,-72 94.32,-72 94.32,-108"></polygon> <text text-anchor="middle" x="47.27" y="-85.8" font-family="Times,serif" font-size="14.00">multiplication</text> </g> <!-- Math --> <g id="node4" class="node">
<title>
Math
</title>
<ellipse fill="none" stroke="black" cx="143.27" cy="-18" rx="71.23" ry="18"></ellipse> <text text-anchor="middle" x="143.27" y="-13.8" font-family="Times,serif" font-size="14.00">Basic Math test</text> </g> <!-- multiplication&#45;&gt;Math --> <g id="edge1" class="edge">
<title>
multiplication-&gt;Math
</title>
<path fill="none" stroke="black" d="M71,-71.7C83.69,-62.44 99.46,-50.95 113.02,-41.06"></path> <polygon fill="black" stroke="black" points="115.11,-43.86 121.13,-35.14 110.99,-38.21 115.11,-43.86"></polygon> </g> <!-- division --> <g id="node2" class="node">
<title>
division
</title>
<polygon fill="none" stroke="black" points="173.89,-108 112.66,-108 112.66,-72 173.89,-72 173.89,-108"></polygon> <text text-anchor="middle" x="143.27" y="-85.8" font-family="Times,serif" font-size="14.00">division</text> </g> <!-- division&#45;&gt;Math --> <g id="edge2" class="edge">
<title>
division-&gt;Math
</title>
<path fill="none" stroke="black" d="M143.27,-71.7C143.27,-63.98 143.27,-54.71 143.27,-46.11"></path> <polygon fill="black" stroke="black" points="146.77,-46.1 143.27,-36.1 139.77,-46.1 146.77,-46.1"></polygon> </g> <!-- subtraction --> <g id="node3" class="node">
<title>
subtraction
</title>
<polygon fill="none" stroke="black" points="270.48,-108 192.07,-108 192.07,-72 270.48,-72 270.48,-108"></polygon> <text text-anchor="middle" x="231.27" y="-85.8" font-family="Times,serif" font-size="14.00">subtraction</text> </g> <!-- subtraction&#45;&gt;Math --> <g id="edge3" class="edge">
<title>
subtraction-&gt;Math
</title>
<path fill="none" stroke="black" d="M209.52,-71.7C198.19,-62.68 184.19,-51.55 171.98,-41.83"></path> <polygon fill="black" stroke="black" points="173.87,-38.87 163.87,-35.38 169.52,-44.35 173.87,-38.87"></polygon> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div><div class="column" style="width:49%;">
<div class="cell">
<div class="cell-output-display">
<div id="cell-handler-fake-div-2">
<p>
<svg width="358" height="116" viewbox="0.00 0.00 358.04 116.00" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" style=" display: block; margin: auto auto auto auto">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 112)"> <polygon fill="white" stroke="transparent" points="-4,4 -4,-112 354.04,-112 354.04,4 -4,4"></polygon> <!-- addition --> <g id="node1" class="node">
<title>
addition
</title>
<polygon fill="none" stroke="black" points="61.82,-108 0.06,-108 0.06,-72 61.82,-72 61.82,-108"></polygon> <text text-anchor="middle" x="30.94" y="-85.8" font-family="Times,serif" font-size="14.00">addition</text> </g> <!-- Math --> <g id="node5" class="node">
<title>
Math
</title>
<ellipse fill="none" stroke="black" cx="174.94" cy="-18" rx="71.23" ry="18"></ellipse> <text text-anchor="middle" x="174.94" y="-13.8" font-family="Times,serif" font-size="14.00">Basic Math test</text> </g> <!-- addition&#45;&gt;Math --> <g id="edge1" class="edge">
<title>
addition-&gt;Math
</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M61.83,-73.98C83.04,-63.67 111.41,-49.88 134.43,-38.69"></path> <polygon fill="black" stroke="black" points="136.14,-41.75 143.6,-34.23 133.08,-35.46 136.14,-41.75"></polygon> </g> <!-- multiplication --> <g id="node2" class="node">
<title>
multiplication
</title>
<polygon fill="none" stroke="black" points="173.99,-108 79.9,-108 79.9,-72 173.99,-72 173.99,-108"></polygon> <text text-anchor="middle" x="126.94" y="-85.8" font-family="Times,serif" font-size="14.00">multiplication</text> </g> <!-- multiplication&#45;&gt;Math --> <g id="edge2" class="edge">
<title>
multiplication-&gt;Math
</title>
<path fill="none" stroke="black" d="M138.81,-71.7C144.44,-63.47 151.3,-53.48 157.51,-44.42"></path> <polygon fill="black" stroke="black" points="160.44,-46.33 163.21,-36.1 154.67,-42.37 160.44,-46.33"></polygon> </g> <!-- division --> <g id="node3" class="node">
<title>
division
</title>
<polygon fill="none" stroke="black" points="253.56,-108 192.32,-108 192.32,-72 253.56,-72 253.56,-108"></polygon> <text text-anchor="middle" x="222.94" y="-85.8" font-family="Times,serif" font-size="14.00">division</text> </g> <!-- division&#45;&gt;Math --> <g id="edge3" class="edge">
<title>
division-&gt;Math
</title>
<path fill="none" stroke="black" d="M211.08,-71.7C205.44,-63.47 198.59,-53.48 192.37,-44.42"></path> <polygon fill="black" stroke="black" points="195.21,-42.37 186.67,-36.1 189.44,-46.33 195.21,-42.37"></polygon> </g> <!-- subtraction --> <g id="node4" class="node">
<title>
subtraction
</title>
<polygon fill="none" stroke="black" points="350.15,-108 271.73,-108 271.73,-72 350.15,-72 350.15,-108"></polygon> <text text-anchor="middle" x="310.94" y="-85.8" font-family="Times,serif" font-size="14.00">subtraction</text> </g> <!-- subtraction&#45;&gt;Math --> <g id="edge4" class="edge">
<title>
subtraction-&gt;Math
</title>
<path fill="none" stroke="black" d="M277.67,-71.88C258.44,-61.98 234.15,-49.47 214.01,-39.11"></path> <polygon fill="black" stroke="black" points="215.58,-35.98 205.08,-34.51 212.37,-42.2 215.58,-35.98"></polygon> </g> </g>
</svg>
</p>
</div>
</div>
</div>
</div>
</div>
<p>content validity = “the extent to which a test measures a representative sample of the subject matter or behavior under investigation”</p>
<p>Inspecting items/variables:</p>
<ul>
<li>does each of the variables measure an aspect of the construct?</li>
<li>is there an important aspect of the construct that is not covered?</li>
<li>expert judgment/agreement</li>
</ul>
</section>
<section id="confirmatory-cfa-factor-analysis" class="slide level1">
<h1>Confirmatory (CFA) factor analysis</h1>
<div class="columns">
<div class="column" style="width:29%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/fa_twofac_labeled.png" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:69%;">
<ul>
<li>specify in advance which loadings should be present (and which should not)</li>
<li>determine how well the model fits the data</li>
<li>other constraints are possible</li>
<li>very flexible technique that is based on SEM</li>
</ul>
</div>
</div>
<h2 id="note">NOTE</h2>
<ul>
<li>CFA should <em>never</em> be run on the same dataset as the EFA to “confirm” it (double-dipping)</li>
<li>when changing the CFA model based on the data, it is not <em>confirmatory</em> anymore</li>
</ul>
</section>
<section id="efa-and-cfa" class="slide level1">
<h1>EFA and CFA</h1>
<p>Are they really exploratory and confirmatory?</p>

<img data-src="pics/exploratory_confirmatory.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>EFA:
<ul>
<li>is often not really exploratory</li>
<li>selection of items theory-driven</li>
<li>choice of analytic steps often driven by theory (drop non-conforming items etc)</li>
</ul></li>
<li>CFA:
<ul>
<li>is often not really confirmatory</li>
<li>changes to the model in the presence of bad model fit</li>
<li>tweaks of CFA model happen often</li>
</ul></li>
</ul>
</section>
<section id="multi-level-regression" class="slide level1">
<h1>Multi-level regression</h1>

<img data-src="pics/multilev.png" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li><p>Useful for data that is organized “hierarchically” or “clustered”</p></li>
<li><p>one datapoint carries information about other datapoint (breaks statistical independence)</p></li>
<li><p>known under many labels:</p>
<ul>
<li><em>random-effect</em> models</li>
<li><em>hierachical regression</em> models</li>
<li><em>multilevel</em> models or</li>
<li><em>mixed-effect</em> models</li>
</ul></li>
</ul>
</section>
<section id="longitudinal-data" class="slide level1">
<h1>Longitudinal data</h1>

<img data-src="pics/longitudinal.png" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>repeated measurements: same person is measured repeatedly</li>
<li>e.g., pre-post measurements, longitudinal data-collection, repeated measures designs</li>
<li>data from the same subjects tends to be similar</li>
<li>e.g., changes in body-weight of infants across the first few months</li>
</ul>
</section>
<section id="nested-data" class="slide level1">
<h1>Nested data</h1>

<img data-src="pics/figure12.01.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>data can also be clustered in other ways</li>
<li>e.g., students from different schools from different districts
<ul>
<li>students differ across time</li>
<li>schools may differ in their grading style (affecting all students)</li>
<li>districts may differ in socio-economic status (affecting all schools)</li>
<li>etc.</li>
</ul></li>
</ul>
</section>
<section id="what-about-sample-size" class="slide level1">
<h1>What about sample size?</h1>

<img data-src="pics/figure12.01.png" style="width:70.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>number of clusters: large enough to estimate group-level variance</li>
<li>number observations within clusters: large enough to estimate within-cluster effects</li>
<li>unequal number of observations within clusters: not a problem (larger clusters will contribute more)</li>
</ul>
</section>
<section id="representing-nestedness" class="slide level1">
<h1>Representing “nestedness”</h1>

<img data-src="pics/wideLong1-1.png" style="width:80.0%" class="r-stretch quarto-figure-center"><p class="caption"></p><p>Wide vs.&nbsp;Long format</p>
</section>
<section id="representing-nestedness-1" class="slide level1">
<h1>Representing “nestedness”</h1>
<div class="cell-output-display">

<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> person </th>
   <th style="text-align:left;"> gender </th>
   <th style="text-align:right;"> age </th>
   <th style="text-align:left;"> diet </th>
   <th style="text-align:right;"> pre.weight </th>
   <th style="text-align:right;"> post.weight </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 58 </td>
   <td style="text-align:right;"> 54.2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 46 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 60 </td>
   <td style="text-align:right;"> 54.0 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 55 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 63.3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 33 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 64 </td>
   <td style="text-align:right;"> 61.1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 5 </td>
   <td style="text-align:left;"> 0 </td>
   <td style="text-align:right;"> 50 </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 65 </td>
   <td style="text-align:right;"> 62.2 </td>
  </tr>
</tbody>
</table>

</div>
<ul>
<li>across different columns: “wide format”</li>
<li>fine for few repeated measures and a single level of “nestedness”</li>
</ul>
</section>
<section id="representing-nestedness-2" class="slide level1">
<h1>Representing “nestedness”</h1>
<div class="cell-output-display">

<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> ID </th>
   <th style="text-align:right;"> BDI1 </th>
   <th style="text-align:right;"> BDI2 </th>
   <th style="text-align:right;"> BDI3 </th>
   <th style="text-align:right;"> BDI4 </th>
   <th style="text-align:right;"> week1 </th>
   <th style="text-align:right;"> week2 </th>
   <th style="text-align:right;"> week3 </th>
   <th style="text-align:right;"> week4 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 6 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:right;"> 23 </td>
   <td style="text-align:right;"> 19 </td>
   <td style="text-align:right;"> 20 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 6 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
</tbody>
</table>

</div>
<ul>
<li>less convenient for multiple variables and many timepoints/levels</li>
<li>use a “long format” instead</li>
</ul>
</section>
<section id="representing-nestedness-3" class="slide level1 smaller">
<h1>Representing “nestedness”</h1>
<div class="cell-output-display">

<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> ID </th>
   <th style="text-align:right;"> week </th>
   <th style="text-align:right;"> BDI </th>
   <th style="text-align:right;"> female </th>
   <th style="text-align:right;"> age </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 22 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 26 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 26 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 26 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:right;"> 3 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 26 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 27 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 34 </td>
  </tr>
</tbody>
</table>

</div>
<ul>
<li>multiple rows for each person</li>
<li>separate variables code for the repeated measures</li>
<li>advantages:
<ul>
<li>more flexible (easy to generalize to multiple levels)</li>
<li>format used by most software packages</li>
</ul></li>
<li>disadvantages:
<ul>
<li>info distributed across multiple rows</li>
<li>information on higher level is redundant</li>
</ul></li>
</ul>
</section>
<section id="variable-slopes" class="slide level1">
<h1>Variable slopes</h1>

<img data-src="lecture5_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>on average, subjects get better over time (during treatment)</li>
<li>individual trajectories are very different!</li>
<li>right figure: independent linear regressions for each subject (“no pooling”)</li>
</ul>
</section>
<section id="partial-pooling" class="slide level1">
<h1>Partial pooling</h1>

<img data-src="lecture5_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>“complete pooling”: person-specific variation lost</li>
<li>“no pooling”: very noisy, little data (low power)</li>
<li><strong>partial pooling</strong>: information about likely slopes and intercepts shared between subjects</li>
</ul>
</section>
<section id="partial-pooling-1" class="slide level1">
<h1>Partial pooling</h1>
<p>Complete pooling:</p>
<p><span class="math display">\[\begin{equation}
Y_i = \beta_0 + \beta_1X_i + \varepsilon_{i},
\label{eq:cpooling}
\end{equation}\]</span></p>
<p>No pooling:</p>
<p><span class="math display">\[\begin{equation}
Y_{ij} = \beta_{0,i} + \beta_{1,i} X_{i,j} + \varepsilon_{i,j}
\label{eq:nopooling}
\end{equation}\]</span></p>
<p><strong>Partial pooling (MLM):</strong></p>
<p><span class="math display">\[\begin{eqnarray}
\label{eq:ppooling}
Y_{ij} &amp;=&amp; \beta_{0} + \beta_{1} X_{i,j} + \color{blue}{u_{i}} + \color{red}{v_{i}} X_{i,j} + \varepsilon_{i,j}\\
&amp;=&amp; (\beta_{0}+ \color{blue}{u_{i}}) + (\beta_{1}+\color{red}{v_{i}}) X_{i,j} +  \varepsilon_{i,j}\nonumber\\
\color{blue}{u_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{blue}{\sigma_u})\nonumber\\
\color{red}{v_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{red}{\sigma_v})\nonumber
\end{eqnarray}\]</span></p>
<ul>
<li>subject-specific <span style="color: blue;">random intercept</span></li>
<li>subject-specific <span style="color: red;">random slope</span></li>
</ul>
</section>
<section id="partial-pooling-2" class="slide level1">
<h1>Partial pooling</h1>

<img data-src="pics/figure12.04.png" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li><strong>shrinkage</strong></li>
<li>typical individual estimates less affected by pooling</li>
<li>extreme estimates are “pulled” towards the average</li>
<li>subjects with lower power (fewer datapoints) are more affected (that’s a feature!)</li>
</ul>
</section>
<section id="random-intercepts-and-slopes" class="slide level1">
<h1>Random Intercepts and slopes</h1>

<img data-src="pics/randint_randslopes.jpg" class="r-stretch quarto-figure-center"><p class="caption"></p><ul>
<li>the <span style="color: blue;">random intercepts</span> are deviations from group intercept (with <span class="math inline">\(\color{blue}{\sigma_u}\)</span>)</li>
<li>the <span style="color: red;">random slopes</span> are deviations from the group slope (with <span class="math inline">\(\color{red}{\sigma_v}\)</span>)</li>
</ul>
</section>
<section id="example-1" class="slide level1 smaller">
<h1>Example</h1>
<p><span class="math display">\[\begin{eqnarray}
Y_{ij} &amp;=&amp; (\beta_{0}+ \color{blue}{u_{i}}) + (\beta_{1}+\color{red}{v_{i}}) X_{i,j} +  \varepsilon_{i,j}\nonumber\\
\color{blue}{u_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{blue}{\sigma_u})\nonumber\\
\color{red}{v_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{red}{\sigma_v})\nonumber
\end{eqnarray}\]</span></p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(BDI <span class="sc">~</span> week <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>week<span class="sc">|</span>ID), <span class="at">data=</span>depression)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ID       (Intercept) 47.4943  6.8916        
          week         0.3707  0.6089   -0.03
 Residual             14.5184  3.8103        
Number of obs: 553, groups:  ID, 85

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept) 19.72818    0.79607 82.13025  24.782  &lt; 2e-16 ***
week        -0.75946    0.08598 58.26743  -8.833 2.41e-12 ***


---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</code></pre>
<ul>
<li>average intercept: <span class="math inline">\(\beta_0=19.7\)</span></li>
<li>average slope: <span class="math inline">\(\beta_1=-0.76\)</span></li>
<li><span style="color: blue;">random intercepts</span> sd: <span class="math inline">\(\color{blue}{\sigma_u}=6.89\)</span></li>
<li><span style="color: red;">random slopes</span> sd: <span class="math inline">\(\color{red}{\sigma_v}=0.61\)</span></li>
</ul>
</section>
<section id="random-intercepts-and-slopes-1" class="slide level1">
<h1>Random Intercepts and slopes</h1>
<div class="columns">
<div class="column" style="width:50%%;">
<p><span class="math display">\[\begin{eqnarray}
Y_{ij} &amp;=&amp; (\beta_{0}+ \color{blue}{u_{i}}) + \beta_{1} X_{i,j} +  \varepsilon_{i,j}\nonumber\\
\color{blue}{u_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{blue}{\sigma_u})\nonumber\\
\end{eqnarray}\]</span></p>
</div><div class="column" style="width:50%%;">
<p><span class="math display">\[\begin{eqnarray}
Y_{ij} &amp;=&amp; (\beta_{0}+ \color{blue}{u_{i}}) + (\beta_{1}+\color{red}{v_{i}}) X_{i,j} +  \varepsilon_{i,j}\nonumber\\
\color{blue}{u_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{blue}{\sigma_u})\nonumber\\
\color{red}{v_{i}} &amp;\sim&amp;  \text{Normal}(0, \color{red}{\sigma_v})\nonumber
\end{eqnarray}\]</span></p>
</div>
</div>

<img data-src="pics/randint_randslopes.jpg" style="width:100.0%" class="r-stretch quarto-figure-center"><p class="caption"></p></section>
<section id="random-intercepts-and-slopes-2" class="slide level1">
<h1>Random Intercepts and slopes</h1>
<p><img data-src="pics/randint_randslopes.jpg" style="width:50.0%"><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(BDI <span class="sc">~</span> week <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>ID), <span class="at">data=</span>depression)</span>
<span id="cb3-2"><a href="#cb3-2"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(BDI <span class="sc">~</span> week <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>week<span class="sc">|</span>ID), <span class="at">data=</span>depression)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">anova</span>(mod1,mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: depression
Models:
mod1: BDI ~ week + (1 | ID)
mod2: BDI ~ week + (1 + week | ID)
     npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
mod1    4 3509.0 3526.3 -1750.5   3501.0                         
mod2    6 3416.1 3442.0 -1702.0   3404.1 96.917  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>do we need both random intercepts and random slopes?</li>
<li>Likelihood-ratio test to compare models</li>
</ul>
</section>
<section id="intra-class-correlation" class="slide level1">
<h1>Intra-class correlation</h1>

<img data-src="pics/icc.jpg" class="r-stretch quarto-figure-center"><p class="caption"></p><div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">icc</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Intraclass Correlation Coefficient

     Adjusted ICC: 0.718
  Conditional ICC: 0.637</code></pre>
</div>
</div>
<ul>
<li>for random-intercepts model: proportion of the variance that is explained by the grouping defined by the random intercepts</li>
<li>low ICC: MLM perhaps unnecessary</li>
</ul>
</section>
<section id="significance-tests-for-mlms" class="slide level1">
<h1>Significance tests for MLMs</h1>
<div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">summary</span>(mod, <span class="at">ddf=</span><span class="st">"Satterthwaite"</span>)<span class="sc">$</span>coefficients</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">summary</span>(mod, <span class="at">ddf=</span><span class="st">"Kenward-Roger"</span>)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>             Estimate Std. Error        df   t value  Pr(&gt;|t|)
(Intercept) 18.643171  4.3740064 3.5531448  4.262264 0.0167478
week        -0.733604  0.2243269 0.3795547 -3.270246 0.4257330</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>             Estimate Std. Error       df   t value   Pr(&gt;|t|)
(Intercept) 18.643171  4.4513612 3.947278  4.188196 0.01421602
week        -0.733604  0.3344458 1.311237 -2.193492 0.22235536</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li>significance tests for MLM coefficients: ongoing debate</li>
<li>two approximate options:
<ul>
<li>Satterthwaite</li>
<li>Kenward-Roger</li>
</ul></li>
<li>or use bootstrapping!</li>
</ul>
</section>
<section id="bootstrap-based-statistical-testing" class="slide level1">
<h1>Bootstrap-based statistical testing</h1>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/Muenchhausen_Herrfurth_7_500x789.jpg" style="width:100.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:60%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/bootstrap.png" style="width:80.0%"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>
<ul>
<li>simulation-based “resampling” of the sample</li>
<li>avoids assumption of normality etc</li>
</ul>
</div>
</div>
</section>
<section id="bootstrap-based-confidence-intervals" class="slide level1">
<h1>Bootstrap-based confidence intervals</h1>
<div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>ci.boot <span class="ot">&lt;-</span> <span class="fu">confint</span>(mod, <span class="at">method=</span><span class="st">"boot"</span>, <span class="at">nsim=</span><span class="dv">1000</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>ci.boot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel" data-hash="lecture5_cache/revealjs/unnamed-chunk-14_424576a091c9e396c02a2b53fd4bfc49">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>                  2.5 %     97.5 %
.sig01       2.57291763 16.9716663
.sig02      -1.00000000  1.0000000
.sig03       0.01685235  1.0315242
.sigma       3.52163916  6.1859672
(Intercept) 10.90393971 27.7395051
week        -1.24740034 -0.2745691</code></pre>
</div>
</div>
</div>
</div>
<ul>
<li>more reliable than the other methods</li>
<li>we also get confidence intervals for the standard-deviations!
<ul>
<li><span style="color: blue;">random intercepts</span>: <span class="math inline">\(\color{blue}{\sigma_u}=6.89 [5.6, 8.1]\)</span></li>
<li><span style="color: red;">random slopes</span> sd: <span class="math inline">\(\color{red}{\sigma_v}=0.61 [0.44, 0.74]\)</span></li>
</ul></li>
</ul>
</section>
<section id="multiple-variables-multiple-levels" class="slide level1">
<h1>Multiple variables, multiple levels</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(BDI <span class="sc">~</span> week<span class="sc">+</span> female<span class="sc">:</span>week <span class="sc">+</span> female <span class="sc">+</span> age <span class="sc">+</span> (<span class="dv">1</span><span class="sc">+</span>week<span class="sc">|</span>ID), </span>
<span id="cb12-2"><a href="#cb12-2"></a>            <span class="at">data=</span>depression)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: BDI ~ week + female:week + female + age + (1 + week | ID)
   Data: depression

REML criterion at convergence: 3398

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8192 -0.5289 -0.0252  0.4602  3.8507 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ID       (Intercept) 42.9054  6.5502        
          week         0.3775  0.6144   -0.04
 Residual             14.5164  3.8100        
Number of obs: 553, groups:  ID, 85

Fixed effects:
            Estimate Std. Error       df t value Pr(&gt;|t|)    
(Intercept) 22.17195    2.98060 82.36193   7.439 8.75e-11 ***
week        -0.80490    0.15760 50.63472  -5.107 5.00e-06 ***
female       3.45063    1.73304 79.84598   1.991   0.0499 *  
age         -0.13705    0.06603 81.50420  -2.076   0.0411 *  
week:female  0.06130    0.18856 53.38371   0.325   0.7464    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) week   female age   
week        -0.089                     
female      -0.556  0.145              
age         -0.872  0.006  0.166       
week:female  0.074 -0.836 -0.176 -0.004</code></pre>
</div>
</div>
<ul>
<li>include additional covariates (on all levels)</li>
<li>include IAs, both between levels and within-levels possible</li>
</ul>
</section>
<section id="a-strategy-to-build-models" class="slide level1">
<h1>A strategy to build models</h1>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="pics/Flow-chart-of-multilevel-model-testing_W640.jpg"></p>
<p></p><figcaption aria-hidden="true"></figcaption><p></p>
</figure>
</div>

<aside><div>
<p>Gath, M. E. (2022). Parents and Adolescents in Stepfamilies: Longitudinal Links to Physical Health, Psychological Distress, and Stress. Journal of Child and Family Studies, 31(1), 17-28.</p>
</div></aside></section>
<section id="extensions" class="slide level1">
<h1>Extensions</h1>
<ul>
<li>multiple random slopes are possible</li>
<li>random “slopes” can be categorical as well</li>
<li>deeper nesting possible</li>
</ul>
<h3 id="other-extensions">Other extensions</h3>
<ul>
<li>General<span style="color:red;">ized</span> linear mixed models (logistic, Poisson, ordinal)</li>
<li>nonlinear mixed effects models</li>
<li>modeling heteroscedasticity between levels/groups</li>
</ul>
</section>
<section id="extensions-deeper-nesting" class="slide level1">
<h1>Extensions: deeper nesting</h1>

<img data-src="pics/machineworker.png" class="r-stretch quarto-figure-center"><p class="caption"></p><div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">lmer</span>(score <span class="sc">~</span> Machine <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Machine <span class="sc">|</span> Worker), machines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>each worker used each of 3 machines 3 times</li>
<li>outcome: productivity score</li>
<li>variability both due to worker and machine!</li>
<li>Nesting: Score <span class="math inline">\(\leftarrow\)</span> Worker <span class="math inline">\(\leftarrow\)</span> Machine</li>
</ul>
</section>
<section id="latent-growth-model" class="slide level1">
<h1>Latent Growth model</h1>
<p><img data-src="pics/latentgrowth.png" style="width:70.0%"><br>
</p>
<ul>
<li>alternative modeling approach based on structural equation modeling</li>
<li>allows embedding in a larger SEM</li>
<li>weigh pro’s and con’s for each application</li>
</ul>
<p><img src="pics/ntnu.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lecture5_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lecture5_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lecture5_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lecture5_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 1000,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>